# 常见错误与开发日志 (Common Issues & Dev Log)

本文档汇总了在开发 TravelAssistant 过程中遇到的常见错误、设计陷阱及解决方案，旨在避免重复踩坑，保持代码库的一致性和高质量。

## 1. 地图与 SVG (Maps & SVG)

### 1.1 时间标注一致性 (Time Label Consistency)
*   **错误现象**: 冬季和夏季地图的时间标注格式不统一（例如 `2h 车程` vs `车程 2h`）。
*   **规范**: 统一使用 **"动作 + 时间"** 或 **"时间 + 补充"** 的简洁格式，并保持全站统一。
    *   ✅ `直飞 4h`
    *   ✅ `车程 2h` (或纯 `2h` 配合图例)
    *   ✅ `返程 4h`
*   **检查点**: 每次新增或修改 SVG 地图时，必须检查所有路径 (`<path>`) 对应的文本 (`<text>`) 标注是否完整且格式一致。

### 1.2 地点重合与复制错误 (Location Overlap & Copy-Paste Errors)
*   **错误现象**:
    *   复制冬季地图作为夏季模板时，忘记修改出发地（例如将“成都”误留为“喀什”）。
    *   节点坐标 (`<g transform="...">`) 未调整，导致新旧节点重叠或连线错乱。
*   **解决方案**:
    *   **模板克隆**: 复制 SVG 代码后，首先**全局搜索并替换**关键地名（如出发地、集散地）。
    *   **坐标复核**: 修改完文本后，务必在预览中检查每个节点的 `transform` 坐标是否合理，确保文字不遮挡路径。

### 1.3 季节性配色 (Seasonal Color Themes)
*   **错误现象**: 夏季方案使用了冬季的配色代码，导致视觉违和。
*   **规范**:
    *   ❄️ **冬季 (Winter)**:
        *   主色: `#3498db` (Blue), `#2980b9` (Dark Blue)
        *   强调: `#e74c3c` (Red - 起点)
        *   背景: `#f0f8ff` (AliceBlue)
    *   🌿 **夏季 (Summer)**:
        *   主色: `#2ecc71` (Green), `#27ae60` (Dark Green)
        *   强调: `#e74c3c` (Red - 起点)
        *   背景: `#f0fff0` (Honeydew)
*   **检查点**: 搜索十六进制颜色代码，确保夏季地图中不出现大面积的蓝色系代码。

### 1.4 箭头方向 (Arrow Markers)
*   **错误现象**: 定义了 `marker-end="url(#arrow-green)"` 但 `<defs>` 中只定义了 `#arrow-blue`，导致箭头不显示。
*   **解决方案**: 每个 SVG 内部必须包含其所引用的 `<marker>` 定义，或者统一在全局 CSS/SVG 中定义（目前采用每个 SVG 独立定义的模式，需注意同步复制）。

## 2. 数据结构 (Data Structure)

### 2.1 方案完整性 (Plan Completeness)
*   **错误现象**: `hasPlan: true` 但实际并未生成对应的详情页或详情模态框内容缺失。
*   **规范**: 标记为 `hasPlan: true` 的方案，必须包含完整的：
    *   `abstractMap`: 抽象地图 SVG
    *   `timeline`: 详细日程
    *   `gear`: 装备建议 (如有特殊需求)
    *   `cost`: 预算明细

## 3. 开发流程建议 (Workflow Tips)

*   **批量修改**: 当需要调整通用样式（如字体、圆角、颜色规范）时，优先使用正则 (Regex) 进行批量替换，但必须人工复核关键的特例。
*   **预览验证**: 修改 SVG 后，务必在浏览器中渲染预览，仅看代码很难发现遮挡或对齐问题。
*   **版本回退**: 大规模修改前，确保 git 状态干净，以便随时回滚。

---
*Last Updated: 2026-01-13*
